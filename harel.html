<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Harel-OS | Command Center</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --app-bg: #e4e5e8;
            --sidebar-bg: #ffffff;
            --chat-bg: #efe7dd; /* 爪注 专拽注 住驻 */
            --primary: #00a884; /* 专拽 住驻 */
            --primary-dark: #008f6f;
            --incoming: #ffffff;
            --outgoing: #d9fdd3;
            --alert-red: #ff3b30;
            --text-main: #111b21;
            --text-secondary: #667781;
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Heebo', sans-serif; background: var(--app-bg); height: 100vh; overflow: hidden; display: flex; justify-content: center; align-items: center; }

        /* === 住专转 专砖转 ( 驻拽爪转 住拽驻) === */
        .app-container {
            width: 100%; height: 100%; max-width: 1600px;
            background: var(--sidebar-bg); display: flex;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative; overflow: hidden;
        }

        /* === 爪 : 专砖转 砖转 住专 === */
        .sidebar {
            width: 400px; border-left: 1px solid #e9edef; display: flex; flex-direction: column;
            background: #fff; z-index: 2;
        }

        /* 住专 注 砖 */
        .my-profile-bar {
            padding: 10px 16px; background: #f0f2f5; display: flex; align-items: center; justify-content: space-between; height: 60px;
        }
        .my-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; cursor: pointer; border: 2px solid transparent; }
        .my-avatar:hover { border-color: var(--primary); }

        /* 住专 */
        .stories-bar {
            padding: 15px 10px; border-bottom: 1px solid #e9edef;
            display: flex; gap: 15px; overflow-x: auto; white-space: nowrap;
        }
        .story-circle {
            width: 55px; height: 55px; border-radius: 50%; padding: 2px;
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            cursor: pointer; position: relative; flex-shrink: 0;
        }
        .story-circle img {
            width: 100%; height: 100%; border-radius: 50%; border: 2px solid white; object-fit: cover;
        }
        .story-circle.add-story { background: #e9edef; display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 24px; }
        .story-name { font-size: 11px; text-align: center; margin-top: 4px; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; width: 55px; }

        /* 专砖转 爪' */
        .chat-list { flex: 1; overflow-y: auto; }
        .chat-item {
            display: flex; padding: 12px 15px; cursor: pointer; border-bottom: 1px solid #f0f2f5; position: relative;
        }
        .chat-item:hover { background: #f5f6f6; }
        .chat-item.active { background: #f0f2f5; border-right: 4px solid var(--primary); }
        
        .avatar-container { position: relative; margin-left: 15px; }
        .chat-avatar { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; background: #ddd; }
        .generated-avatar { width: 50px; height: 50px; border-radius: 50%; background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; }
        
        .chat-info { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .chat-name { font-weight: 500; font-size: 16px; color: var(--text-main); display: flex; justify-content: space-between; }
        .chat-time { font-size: 12px; color: var(--text-secondary); font-weight: normal; }
        .chat-preview { font-size: 13px; color: var(--text-secondary); margin-top: 3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 250px; }

        /* === 爪 砖:  砖 === */
        .chat-window {
            flex: 1; display: flex; flex-direction: column; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
            background-color: var(--chat-bg); background-repeat: repeat; position: relative;
        }
        
        /*  专拽注 砖 砖 */
        .no-chat-bg {
            position: absolute; top:0; left:0; width:100%; height:100%; background: #f0f2f5; z-index: 10;
            display: flex; flex-direction: column; align-items: center; justify-content: center; color: #667781;
        }

        .chat-header {
            padding: 10px 20px; background: #f0f2f5; border-bottom: 1px solid #d1d7db;
            display: flex; align-items: center; height: 60px; justify-content: space-between;
        }
        .header-info { display: flex; align-items: center; cursor: pointer; }
        .header-avatar { width: 40px; height: 40px; border-radius: 50%; margin-left: 15px; object-fit: cover; }
        
        .admin-controls-btn {
            background: transparent; border: 1px solid var(--text-secondary); border-radius: 20px;
            padding: 5px 12px; font-size: 12px; color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; gap: 5px;
        }
        .admin-controls-btn:hover { background: #e9edef; }

        /* 专 注转 */
        .messages-area { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        
        .msg {
            max-width: 60%; padding: 8px 12px; border-radius: 8px; font-size: 14px; line-height: 1.4;
            position: relative; box-shadow: 0 1px 0.5px rgba(0,0,0,0.13); display: flex; flex-direction: column;
        }
        .msg.sent { align-self: flex-start; background: var(--outgoing); border-top-right-radius: 0; }
        .msg.received { align-self: flex-end; background: var(--incoming); border-top-left-radius: 0; } /* 砖拽 注专转, 爪 砖  received */
        
        /* 住 注转  */
        .msg.alert {
            background: #ffebee; border: 1px solid var(--alert-red);
        }
        .msg.alert::before { content: ''; font-size: 20px; position: absolute; top: -10px; right: -10px; }
        
        .msg-meta { font-size: 10px; color: rgba(0,0,0,0.45); align-self: flex-end; margin-top: 4px; display: flex; align-items: center; gap: 3px; }

        /* 专 拽 */
        .input-area {
            min-height: 60px; background: #f0f2f5; padding: 10px 20px; display: flex; align-items: center; gap: 10px;
        }
        
        .icon-btn { color: var(--text-secondary); cursor: pointer; padding: 8px; border-radius: 50%; transition: 0.2s; }
        .icon-btn:hover { background: rgba(0,0,0,0.05); }
        .icon-btn.active-alert { color: var(--alert-red); background: #ffebee; animation: pulse 1s infinite; }
        
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        .text-input {
            flex: 1; padding: 12px 15px; border-radius: 8px; border: none; background: white; font-family: inherit; font-size: 15px;
        }
        
        /* ===  === */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100;
            display: none; align-items: center; justify-content: center;
        }
        .modal-box {
            background: white; width: 350px; border-radius: 15px; padding: 25px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3); position: relative;
        }
        .close-modal { position: absolute; top: 10px; left: 10px; cursor: pointer; color: #888; }
        
        .upload-area {
            border: 2px dashed #ccc; border-radius: 10px; padding: 30px; margin: 20px 0; cursor: pointer; color: #666;
        }
        .upload-area:hover { border-color: var(--primary); color: var(--primary); background: #f0fbf5; }

        /* === 转爪转 住专 === */
        .story-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 200;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        .story-bar-top {
            position: absolute; top: 20px; width: 90%; height: 3px; background: rgba(255,255,255,0.3); border-radius: 2px;
        }
        .story-progress { height: 100%; width: 0%; background: white; }

    </style>
</head>
<body>

    <div class="app-container">
        
        <div class="sidebar">
            <div class="my-profile-bar">
                <img src="https://ui-avatars.com/api/?name=Harel+Idelson&background=00a884&color=fff" class="my-avatar" title="驻专驻 砖">
                <div style="display:flex; gap:15px; color:#54656f;">
                    <i class="material-icons icon-btn" onclick="newStory()">add_circle_outline</i>
                    <i class="material-icons icon-btn" title="注转 专">campaign</i>
                    <i class="material-icons icon-btn">more_vert</i>
                </div>
            </div>

            <div class="stories-bar" id="stories-feed">
                <div class="story-circle add-story" onclick="newStory()">
                    <i class="material-icons">add</i>
                </div>
                </div>

            <div class="chat-list" id="chat-list">
                </div>
        </div>

        <div class="chat-window">
            <div class="no-chat-bg" id="no-chat-screen">
                <i class="material-icons" style="font-size: 80px; margin-bottom: 20px;">laptop_mac</i>
                <h2 style="font-weight: 300;">Harel-OS Command Center</h2>
                <p>专 砖  转 , 砖专 住  驻注 拽.</p>
                <div style="font-size: 12px; margin-top: 20px; color: #888;"> 注专转 爪驻转 转</div>
            </div>

            <div class="chat-header" id="chat-header" style="display:none;">
                <div class="header-info" onclick="openProfileSettings()">
                    <img src="" class="header-avatar" id="active-avatar">
                    <div style="display:flex; flex-direction:column; margin-right: 15px;">
                        <span style="font-weight:bold; font-size:16px;" id="active-name">砖</span>
                        <span style="font-size:12px; color:var(--text-secondary);" id="active-status">专 专  -08:30</span>
                    </div>
                </div>
                <button class="admin-controls-btn" onclick="openProfileSettings()">
                    <i class="material-icons">admin_panel_settings</i>  驻专驻
                </button>
            </div>

            <div class="messages-area" id="msg-area" style="display:none;"></div>

            <div class="input-area" id="input-area" style="display:none;">
                <i class="material-icons icon-btn" title="爪专祝 住/转注" onclick="uploadDoc()">attach_file</i>
                <i class="material-icons icon-btn" id="alert-btn" title="爪 拽 (注拽)" onclick="toggleAlertMode()">notifications_paused</i>
                <input type="text" class="text-input" id="msg-input" placeholder="拽 注..." onkeypress="handleKey(event)">
                <i class="material-icons icon-btn" style="color:var(--primary);" onclick="sendMessage()">send</i>
            </div>
        </div>
    </div>

    <div class="modal" id="profile-modal">
        <div class="modal-box">
            <i class="material-icons close-modal" onclick="closeModal('profile-modal')">close</i>
            <h3> 专住 注</h3>
            <p style="font-size:13px; color:#666;">, 转 砖 转 砖 <span id="modal-user-name" style="font-weight:bold;"></span></p>
            
            <img src="" id="modal-current-img" style="width:100px; height:100px; border-radius:50%; margin: 15px auto; display:block; object-fit:cover;">
            
            <div class="upload-area" onclick="simulateUploadProfile()">
                <i class="material-icons" style="font-size:30px;">cloud_upload</i>
                <div>抓 注转 转 砖</div>
            </div>
            
            <button onclick="saveProfile()" style="background:var(--primary); color:white; border:none; padding:10px 20px; border-radius:5px; width:100%; font-size:16px; cursor:pointer;">砖专 砖</button>
        </div>
    </div>

    <div class="story-overlay" id="story-view" onclick="closeStory()">
        <div class="story-bar-top"><div class="story-progress" id="story-bar"></div></div>
        <img src="" id="story-img" style="max-width:100%; max-height:80vh; border-radius:10px;">
        <div id="story-text" style="color:white; font-size:24px; margin-top:20px; font-weight:bold; padding:20px; text-align:center;"></div>
    </div>

    <script>
        // === 转  ===
        const users = [
            { id: 1, name: '住  (祝 10)', img: '', lastMsg: '注转 转专, 转 驻专拽', time: '10:30', unread: 2 },
            { id: 2, name: ' 住拽', img: 'https://i.pravatar.cc/150?u=2', lastMsg: '转注转 砖 ?', time: '09:15', unread: 0 },
            { id: 3, name: '拽爪转 注转 (.住)', type: 'group', img: '', lastMsg: '专: 砖   砖', time: '转', unread: 0 },
            { id: 4, name: '砖 住', img: '', lastMsg: '住专  砖专', time: '转', unread: 0 }
        ];

        const stories = [
            { user: '专 ()', img: 'https://images.unsplash.com/photo-1504384308090-c54be3855833?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60', text: '拽专  , 砖转 爪转 -10!' }
        ];

        let activeChatId = null;
        let isAlertMode = false;

        // === 转 ===
        window.onload = function() {
            renderChatList();
            renderStories();
        };

        // === 驻拽爪转 转爪 ===
        function renderChatList() {
            const list = document.getElementById('chat-list');
            list.innerHTML = '';
            users.forEach(u => {
                const initial = u.name.charAt(0);
                const avatarHtml = u.img 
                    ? `<img src="${u.img}" class="chat-avatar">` 
                    : `<div class="generated-avatar">${initial}</div>`;
                
                const activeClass = activeChatId === u.id ? 'active' : '';
                const unreadBadge = u.unread > 0 ? `<span style="background:#25d366; color:white; font-size:10px; padding:3px 6px; border-radius:10px;">${u.unread}</span>` : '';

                list.innerHTML += `
                    <div class="chat-item ${activeClass}" onclick="openChat(${u.id})">
                        <div class="avatar-container">${avatarHtml}</div>
                        <div class="chat-info">
                            <div class="chat-name">
                                <span>${u.name}</span>
                                <span class="chat-time">${u.time}</span>
                            </div>
                            <div class="chat-preview" style="display:flex; justify-content:space-between;">
                                <span>${u.lastMsg}</span>
                                ${unreadBadge}
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function renderStories() {
            const container = document.getElementById('stories-feed');
            // 砖专 注 驻转专 住驻
            container.innerHTML = `<div class="story-circle add-story" onclick="newStory()"><i class="material-icons">add</i></div>`;
            
            stories.forEach((s, idx) => {
                //  砖转砖  转, 砖转砖  专  驻住专
                const img = s.img || 'https://via.placeholder.com/150';
                container.innerHTML += `
                    <div style="display:flex; flex-direction:column; align-items:center;">
                        <div class="story-circle" onclick="viewStory(${idx})">
                            <img src="${img}">
                        </div>
                        <div class="story-name">${s.user}</div>
                    </div>
                `;
            });
        }

        function openChat(id) {
            activeChatId = id;
            const user = users.find(u => u.id === id);
            
            document.getElementById('no-chat-screen').style.display = 'none';
            document.getElementById('chat-header').style.display = 'flex';
            document.getElementById('msg-area').style.display = 'flex';
            document.getElementById('input-area').style.display = 'flex';

            document.getElementById('active-name').innerText = user.name;
            document.getElementById('active-avatar').src = user.img || `https://ui-avatars.com/api/?name=${user.name}&background=random`;
            
            // 驻住 专 注转 (住爪)
            const area = document.getElementById('msg-area');
            area.innerHTML = '';
            // 注 住专转 
            addMessage(user.lastMsg, 'received');
            
            renderChatList(); // 注 -Active state
        }

        // === 拽转 注转 ===
        function handleKey(e) { if(e.key === 'Enter') sendMessage(); }

        function sendMessage() {
            const input = document.getElementById('msg-input');
            const text = input.value.trim();
            if(!text) return;

            // 拽转 爪 拽
            if(isAlertMode) {
                addMessage(text, 'sent alert');
                // 住爪 砖  拽
                setTimeout(() => alert(' 拽 驻注 爪 ' + document.getElementById('active-name').innerText), 500);
            } else {
                addMessage(text, 'sent');
            }

            // 注 专砖
            const user = users.find(u => u.id === activeChatId);
            user.lastMsg = (isAlertMode ? ' ' : '') + text;
            user.time = '注砖';
            renderChatList();

            input.value = '';
            // 驻住 拽 专 砖
            if(isAlertMode) toggleAlertMode();
        }

        function addMessage(text, type) {
            const area = document.getElementById('msg-area');
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            const div = document.createElement('div');
            let className = 'msg';
            if(type.includes('sent')) className += ' sent';
            if(type.includes('received')) className += ' received';
            if(type.includes('alert')) className += ' alert';

            //  拽 住
            if(text.includes('DOC-LINK')) {
                text = `<a href="#" style="color:#00a884; font-weight:bold; text-decoration:none;"> 转注转 砖 (抓 爪驻)</a>`;
            }

            div.className = className;
            div.innerHTML = `
                ${text}
                <div class="msg-meta">
                    ${time} 
                    ${type.includes('sent') ? '<i class="material-icons" style="font-size:12px; color:#53bdeb;">done_all</i>' : ''}
                </div>
            `;
            area.appendChild(div);
            area.scrollTop = area.scrollHeight;
        }

        function toggleAlertMode() {
            isAlertMode = !isAlertMode;
            const btn = document.getElementById('alert-btn');
            const inp = document.getElementById('msg-input');
            
            if(isAlertMode) {
                btn.classList.add('active-alert');
                btn.innerText = 'notifications_active';
                inp.placeholder = ' 拽 注转 专...';
                inp.style.border = '2px solid var(--alert-red)';
            } else {
                btn.classList.remove('active-alert');
                btn.innerText = 'notifications_paused';
                inp.placeholder = '拽 注...';
                inp.style.border = 'none';
            }
        }

        // === 拽转 住 ===
        function uploadDoc() {
            const inp = document.getElementById('msg-input');
            inp.value = '...注 转注...';
            inp.disabled = true;
            
            setTimeout(() => {
                const docId = Math.floor(Math.random() * 1000) + 5000;
                inp.value = `爪专驻转 转注转 砖 #${docId} (DOC-LINK)`;
                inp.disabled = false;
                inp.focus();
            }, 1000);
        }

        // === 拽转  (驻专驻) ===
        function openProfileSettings() {
            const user = users.find(u => u.id === activeChatId);
            if(!user) return;
            document.getElementById('modal-user-name').innerText = user.name;
            document.getElementById('modal-current-img').src = user.img || `https://ui-avatars.com/api/?name=${user.name}&background=random`;
            document.getElementById('profile-modal').style.display = 'flex';
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function simulateUploadProfile() {
            // 住爪 砖 专转 拽抓
            const newImg = "https://cdn-icons-png.flaticon.com/512/3135/3135715.png"; // 转转 
            document.getElementById('modal-current-img').src = newImg;
            document.getElementById('modal-current-img').dataset.temp = newImg;
            alert('转 专! 抓 注 砖专  注.');
        }

        function saveProfile() {
            const user = users.find(u => u.id === activeChatId);
            const newSrc = document.getElementById('modal-current-img').dataset.temp;
            if(newSrc) {
                user.img = newSrc;
                renderChatList();
                // 注  转专转 砖
                document.getElementById('active-avatar').src = newSrc;
            }
            closeModal('profile-modal');
        }

        // === 拽转 住专 ===
        function newStory() {
            const text = prompt('转 住专 砖 (注  专):');
            if(text) {
                stories.unshift({ user: '专 ()', img: 'https://via.placeholder.com/500/00a884/ffffff?text=Announcement', text: text });
                renderStories();
            }
        }

        function viewStory(idx) {
            const s = stories[idx];
            document.getElementById('story-view').style.display = 'flex';
            document.getElementById('story-img').src = s.img;
            document.getElementById('story-text').innerText = s.text;
            
            // 爪转 专 转拽转
            const bar = document.getElementById('story-bar');
            bar.style.transition = 'none';
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.transition = 'width 3s linear';
                bar.style.width = '100%';
            }, 10);
            
            setTimeout(closeStory, 3000);
        }

        function closeStory() { document.getElementById('story-view').style.display = 'none'; }

    </script>
</body>
</html>
